# PC操作支援アプリケーション（自動スクリーンショット版）

PCで操作をしている際、アプリでもゲームでも不明点があったら教えてくれるAI支援アプリケーションです。

## 🆕 新機能: 自動スクリーンショット

**質問を入力すると自動的にスクリーンショットを撮影**し、AIが画面を解析して回答します。これにより、質問とスクリーンショット撮影が一つの操作で完了します。

## 🌟 主な機能

- **🚀 質問時自動スクリーンショット**: 質問を送信すると自動的にスクリーンショットを撮影

- **🔄 ON/OFF切り替え**: 自動スクリーンショット機能の有効/無効を簡単に切り替え

- **📷 手動スクリーンショット**: 必要に応じて手動でもスクリーンショット撮影可能

- **🤖 AI画面解析**: OpenAI GPT-4 Vision APIを使用して画面内容を理解

- **🎤 音声質問**: 音声で質問を入力可能

- **⌨️ テキスト質問**: テキストでも質問を入力可能

- **🎯 操作指示**: 画面上に赤い矢印で操作箇所を表示

- **🔄 常駐機能**: バックグラウンドで動作し、必要時に即座に利用可能

## 🚀 クイックスタート

### 1. 実行

```python
cd pc_assistant_app
python3 run_auto_screenshot.py
```

### 2. 基本的な使用方法

1. **❓ 質問入力**
  - テキストボックスに質問を入力
  - 「🚀 質問する（自動SS付き）」ボタンをクリック
  - **自動的にスクリーンショットが撮影されます**

1. **🤖 AI回答の確認**
  - AIが画面を解析して回答を表示
  - 必要に応じて画面上に赤い矢印で操作箇所を指示

## 🎛️ 機能設定

### 自動スクリーンショットのON/OFF

- **有効時**: 質問送信と同時に自動でスクリーンショット撮影

- **無効時**: 従来通り手動でスクリーンショット撮影が必要

- UIの「🔄 質問時に自動でスクリーンショット撮影」チェックボックスで切り替え

### 手動スクリーンショット

自動機能に加えて、以下の方法で手動撮影も可能：

- 「📷 手動スクリーンショット」ボタンをクリック

- `Ctrl+Alt+S`（利用可能な場合）

## 📋 使用例

### 基本的な操作フロー

1. **アプリケーションを起動**

1. **質問を入力**
  - 例: "このボタンは何をするものですか？"

1. **質問を送信**
  - 「🚀 質問する（自動SS付き）」ボタンをクリック
  - 自動的にスクリーンショットが撮影される

1. **AI回答を確認**
  - AIが画面を解析して詳細な回答を提供
  - 必要に応じて操作箇所に赤い矢印を表示

### 質問例

- "このエラーメッセージの意味を教えてください"

- "次に何をすればいいですか？"

- "この設定をどこで変更できますか？"

- "このアプリの使い方を教えてください"

- "保存ボタンはどこにありますか？"

## 🔧 技術仕様

### 新機能の実装

| 機能 | 説明 | 実装ファイル |
| --- | --- | --- |
| **自動スクリーンショット** | 質問送信時に自動撮影 | `main_controller_auto_screenshot.py` |
| **ON/OFF切り替え** | チェックボックスで制御 | `ui_module_auto_screenshot.py` |
| **手動撮影オプション** | 従来の手動撮影も維持 | 全モジュール |

### ファイル構成

```
pc_assistant_app/
├── run_auto_screenshot.py              # 自動スクリーンショット版実行スクリプト
├── main_controller_auto_screenshot.py  # 自動スクリーンショット版メインコントローラー
├── ui_module_auto_screenshot.py        # 自動スクリーンショット版UIモジュール
├── capture_module_improved.py          # 改良版画面キャプチャモジュール
├── speech_module.py                   # 音声認識モジュール
├── ai_module.py                       # AI解析モジュール
├── overlay_module.py                  # オーバーレイ表示モジュール
└── README_AUTO_SCREENSHOT.md          # このファイル
```

## 🆚 従来版との比較

| 項目 | 従来版 | 自動スクリーンショット版 |
| --- | --- | --- |
| **操作手順** | 1. スクリーンショット撮影
2. 質問入力  
3. 送信 | 1. 質問入力
2. 送信（自動撮影） |
| **ボタン数** | 2回クリック | 1回クリック |
| **使いやすさ** | 手順が多い | シンプル |
| **柔軟性** | 撮影タイミングを制御可能 | 自動化で効率的 |

## 💡 使用上のヒント

### 効果的な使い方

1. **質問を具体的に**: "このボタンは何ですか？" より "右上の青いボタンは何をするものですか？"

1. **画面を整理**: 質問に関連する部分が見えるように画面を調整

1. **自動機能を活用**: 頻繁に質問する場合は自動スクリーンショットを有効に

1. **手動撮影も併用**: 特定のタイミングで撮影したい場合は手動機能を使用

### トラブルシューティング

#### 自動スクリーンショットが動作しない

1. **チェックボックスの確認**: 「🔄 質問時に自動でスクリーンショット撮影」が有効になっているか

1. **権限の確認**: アプリケーションに画面キャプチャの権限があるか

1. **手動撮影でテスト**: 「📷 手動スクリーンショット」ボタンで動作確認

#### 質問が処理されない

1. **スクリーンショットの確認**: 自動撮影が成功しているか

1. **APIキーの確認**: OpenAI APIキーが正しく設定されているか

1. **ネットワーク接続**: インターネット接続が正常か

## 🔮 今後の改良予定

- **撮影遅延設定**: 質問送信から撮影までの遅延時間を調整可能に

- **複数画面対応**: マルチモニター環境での画面選択機能

- **撮影範囲指定**: 画面の一部分のみを撮影する機能

- **履歴機能**: 過去の質問とスクリーンショットの履歴表示

## 🎉 まとめ

自動スクリーンショット版では、**質問とスクリーンショット撮影が一体化**し、より直感的で効率的なPC操作支援を実現しました。

従来の2ステップ操作が1ステップになり、**ユーザビリティが大幅に向上**しています。

---

**🚀 より簡単に、より効率的に PC操作支援をお楽しみください！**

